# 外部ホスティングサービスとの連携

広聴AIでは、レポートの静的ファイルを外部ホスティングサービス（NetlifyとVercel）に直接デプロイする機能を提供しています。この機能を使用することで、レポートを簡単に公開し、外部の関係者と共有することができます。

## 前提条件

外部ホスティングサービスとの連携を使用するには、以下の準備が必要です：

1. NetlifyまたはVercelのアカウント
2. 各サービスのAPIトークン
3. 環境変数の設定

## APIトークンの取得方法

### Netlify APIトークンの取得

1. [Netlify](https://app.netlify.com/)にログインします
2. 右上のユーザーアイコンをクリックし、「User settings」を選択します
3. 左側のメニューから「Applications」を選択します
4. 「Personal access tokens」セクションで「New access token」ボタンをクリックします
5. トークンの説明を入力し、必要な権限を選択します（少なくとも「sites:write」権限が必要です）
6. 「Generate token」ボタンをクリックします
7. 生成されたトークンをコピーします（このトークンは一度しか表示されないので注意してください）

### Vercel APIトークンの取得

1. [Vercel](https://vercel.com/dashboard)にログインします
2. 右上のユーザーアイコンをクリックし、「Settings」を選択します
3. 左側のメニューから「Tokens」を選択します
4. 「Create Token」ボタンをクリックします
5. トークンの名前を入力し、必要な権限を選択します（フルアクセス権限を推奨）
6. 「Create」ボタンをクリックします
7. 生成されたトークンをコピーします（このトークンは一度しか表示されないので注意してください）

## 環境変数の設定

取得したAPIトークンを広聴AIの環境変数に設定します：

1. `.env`ファイルを開きます
2. 以下の環境変数を追加します：

```
# 外部ホスティングサービス
# Netlifyへのデプロイに必要なAPIトークン
NETLIFY_AUTH_TOKEN=your_netlify_token_here
# Vercelへのデプロイに必要なAPIトークン
VERCEL_AUTH_TOKEN=your_vercel_token_here
```

3. 環境変数を設定した後、アプリケーションを再起動します：

```sh
docker compose down
docker compose up --build
```

## 使用方法

1. 管理画面（http://localhost:4000）にアクセスします
2. レポート一覧から、デプロイしたいレポートを見つけます
3. レポートの「Ready」ステータスのカードに表示される「クラウド」アイコンをクリックします
4. デプロイ先として「Netlifyに公開」または「Vercelに公開」を選択します
5. デプロイが完了すると、公開URLが表示されます

## 注意事項

- デプロイには、レポートのサイズによって数分かかる場合があります
- 公開されたレポートは誰でもアクセス可能になるため、機密情報が含まれていないことを確認してください
- APIトークンは機密情報です。安全に管理し、公開リポジトリにコミットしないでください
- 大規模なレポート（入力データが10,000件を超えるもの）の場合、デプロイに時間がかかる場合があります
